spring:
  application:
    name: aitradex-service
app:
  uploads:
    directory: ${APP_UPLOADS_DIRECTORY:./data/uploads}
    max-size-mb: ${APP_UPLOADS_MAX_SIZE_MB:25}
    max-validation-errors: ${APP_UPLOADS_MAX_VALIDATION_ERRORS:50}
  market-data:
    default-source: ${APP_MARKET_DATA_DEFAULT_SOURCE:alphavantage}
    cache-ttl: ${APP_MARKET_DATA_CACHE_TTL:30s}
    cache-evict-interval-ms: ${APP_MARKET_DATA_CACHE_EVICT_MS:300000}
    stream-poll-interval: ${APP_MARKET_DATA_STREAM_POLL_INTERVAL:10s}
    stream-max-duration: ${APP_MARKET_DATA_STREAM_MAX_DURATION:5m}
    providers:
      alphavantage:
        enabled: true
        priority: 1
      yahoo:
        enabled: false  # Disabled: unreliable/may fail
        priority: 2
      stooq:
        enabled: false  # Disabled: unreliable/may fail
        priority: 3
      quote-snapshots:
        enabled: true
        priority: 4
  alpha-vantage:
    api-key: ${ALPHA_VANTAGE_API_KEY:B8IQ3ONTC1RTKRH7}
    base-url: ${ALPHA_VANTAGE_BASE_URL:https://www.alphavantage.co}
    enabled: ${ALPHA_VANTAGE_ENABLED:true}
  stop-loss:
    poll-interval-ms: ${APP_STOP_LOSS_POLL_MS:60000}
    source: ${APP_STOP_LOSS_SOURCE:quote-snapshots}
  snapshots:
    poll-interval-ms: ${APP_SNAPSHOT_POLL_MS:300000}
  datasource:
    url: jdbc:postgresql://localhost:5432/aitradex
    username: aitradex
    password: aitradex
  jpa:
    hibernate:
      ddl-auto: none
    open-in-view: false
    properties:
      hibernate:
        format_sql: true
  liquibase:
    change-log: classpath:db/changelog/db.changelog-master.yaml

server:
  port: 8080

management:
  endpoints:
    web:
      exposure:
        include: health, info
  endpoint:
    health:
      show-details: when_authorized

springdoc:
  api-docs:
    path: /api/docs
  swagger-ui:
    path: /api/swagger-ui.html

logging:
  level:
    root: INFO

---
spring:
  config:
    activate:
      on-profile: dev
  datasource:
    url: jdbc:postgresql://localhost:5432/aitradex
    username: aitradex
    password: aitradex
  liquibase:
    contexts: dev

logging:
  level:
    org.hibernate.SQL: DEBUG
    org.springframework: INFO

---
spring:
  config:
    activate:
      on-profile: test
  datasource:
    url: jdbc:postgresql://localhost:5432/aitradex_test
    username: aitradex
    password: aitradex
  liquibase:
    contexts: test

logging:
  level:
    root: WARN

---
spring:
  config:
    activate:
      on-profile: prod
  datasource:
    url: jdbc:postgresql://localhost:5432/aitradex
    username: ${POSTGRES_USER:aitradex}
    password: ${POSTGRES_PASSWORD:aitradex}
  liquibase:
    contexts: prod

server:
  port: ${PORT:8080}
management:
  endpoints:
    web:
      exposure:
        include: health, info
